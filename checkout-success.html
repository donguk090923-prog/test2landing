<!DOCTYPE html>
<html class="light" lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>결제 완료 | 아울도어</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Epilogue:wght@400;500;700;900&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        "primary": "#496039",
                        "background-light": "#f7f7f6",
                        "accent-brass": "#b29d71"
                    },
                    fontFamily: {
                        "display": ["Epilogue", "Noto Sans KR", "sans-serif"]
                    },
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; }
        body { font-family: 'Epilogue', 'Noto Sans KR', sans-serif; }
        @keyframes checkmark {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-checkmark { animation: checkmark 0.5s ease-out forwards; }
    </style>
</head>
<body class="bg-background-light min-h-screen flex flex-col">
<!-- Navigation -->
<header class="w-full bg-white border-b border-gray-100">
    <div class="mx-auto flex max-w-[1280px] items-center justify-between px-6 py-4 lg:px-12">
        <a href="index.html" class="flex items-center gap-2">
            <div class="text-primary">
                <svg class="size-8" fill="currentColor" viewbox="0 0 48 48">
                    <path d="M44 4H30.6666V17.3334H17.3334V30.6666H4V44H44V4Z"></path>
                </svg>
            </div>
            <h1 class="text-xl font-black tracking-tight text-primary">아울도어</h1>
        </a>
    </div>
</header>

<main class="flex-1 flex items-center justify-center px-6 py-12">
    <div class="max-w-lg w-full text-center">
        <!-- Success Icon -->
        <div class="w-24 h-24 mx-auto mb-8 rounded-full bg-green-100 flex items-center justify-center animate-checkmark">
            <span class="material-symbols-outlined text-5xl text-green-500" style="font-variation-settings: 'FILL' 1;">check_circle</span>
        </div>

        <h1 class="text-3xl font-black text-gray-900 mb-4">결제가 완료되었습니다!</h1>
        <p class="text-gray-500 mb-8">주문해 주셔서 감사합니다. 아래에서 주문 내역을 확인하세요.</p>

        <!-- Order Summary Card -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 text-left mb-8">
            <h2 class="text-lg font-bold mb-4 pb-4 border-b border-gray-100">주문 정보</h2>

            <div class="space-y-3">
                <div class="flex justify-between">
                    <span class="text-gray-500">주문번호</span>
                    <span id="order-id" class="font-medium">-</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-500">결제금액</span>
                    <span id="amount" class="font-bold text-primary">-</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-500">결제수단</span>
                    <span id="payment-method" class="font-medium">-</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-500">결제일시</span>
                    <span id="payment-date" class="font-medium">-</span>
                </div>
            </div>

            <div class="mt-6 pt-6 border-t border-gray-100">
                <div class="flex items-start gap-3 p-4 bg-blue-50 rounded-xl">
                    <span class="material-symbols-outlined text-blue-500">info</span>
                    <div class="text-sm">
                        <p class="font-medium text-blue-700">다음 단계 안내</p>
                        <p class="text-blue-600 mt-1">담당자가 1시간 이내로 연락드려 시공 일정을 조율합니다.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-3">
            <a href="mypage.html" class="flex-1 py-4 rounded-xl bg-primary text-white font-bold text-center hover:bg-opacity-90 transition-all">
                주문 내역 확인
            </a>
            <a href="index.html" class="flex-1 py-4 rounded-xl border-2 border-gray-200 text-gray-700 font-bold text-center hover:border-primary hover:text-primary transition-all">
                홈으로 돌아가기
            </a>
        </div>

        <!-- Contact Info -->
        <div class="mt-8 text-sm text-gray-500">
            <p>문의사항이 있으시면 고객센터로 연락해주세요.</p>
            <p class="font-medium text-gray-700 mt-1">1588-0000 (평일 09:00~18:00)</p>
        </div>
    </div>
</main>

<!-- Footer -->
<footer class="bg-white py-6 px-6 border-t border-gray-100">
    <div class="mx-auto max-w-[1280px] text-center text-sm text-gray-500">
        © 2024 아울도어 Inc. All rights reserved.
    </div>
</footer>

<!-- Configuration -->
<script src="config.js"></script>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
<!-- Firebase Config -->
<script src="firebase-config.js"></script>

<script>
// URL 파라미터에서 결제 정보 추출
const urlParams = new URLSearchParams(window.location.search);
const orderId = urlParams.get('orderId') || '-';
const paymentKey = urlParams.get('paymentKey');
const amount = urlParams.get('amount');

// 주문 정보 표시
document.getElementById('order-id').textContent = orderId;
document.getElementById('amount').textContent = amount ? Number(amount).toLocaleString() + '원' : '100원';
document.getElementById('payment-method').textContent = '신용카드';
document.getElementById('payment-date').textContent = new Date().toLocaleString('ko-KR');

// Firebase 주문 상태 업데이트
async function updatePaymentStatus() {
    if (orderId && orderId !== '-') {
        try {
            await updateOrderStatus(orderId, 'paid', {
                paymentKey: paymentKey,
                amount: amount,
                paidAt: new Date().toISOString()
            });
            console.log('결제 상태가 Firebase에 업데이트되었습니다.');
        } catch (error) {
            console.error('결제 상태 업데이트 실패:', error);
        }
    }
}

// 페이지 로드 시 결제 상태 업데이트
window.addEventListener('load', () => {
    // Firebase 초기화 후 업데이트 실행
    setTimeout(updatePaymentStatus, 1000);
});
</script>
</body>
</html>
